#!/bin/bash

cd /tmp/rom # Depends on where source got synced
rm -rf .repo & # lets remove unnecessary things, so that no storage issue can occur

# Normal build steps
. build/envsetup.sh
lunch lineage_lavender-userdebug
export CCACHE_DIR=/tmp/ccache
export CCACHE_EXEC=$(which ccache)
export USE_CCACHE=1
#export SDCLANG_PATH=vendor/qcom/proprietary/llvm-arm-toolchain-ship/8.0/bin
ccache -M 50G
ccache -o compression=true
ccache -z
#make api-stubs-docs || echo no problem, we need ccache
#make hiddenapi-lists-docs || echo no problem, we need ccache
#make system-api-stubs-docs || echo no problem we need ccache
#make test-api-stubs-docs || echo no problem, we need ccache
make bacon -j35 &
sleep 60m
kill %1
ccache -s

 #stuffs(dont remove##)
#up(){
	#curl --upload-file $1 https://transfer.sh/
#}

#make_metalava(){
	#make api-stubs-docs -j12
	#make system-api-stubs-docs -j12
	#make test-api-stubs-docs -j12
#}

#make_rom(){
                #make bacon -j28
                #mma ThemePicker -j28
		##zip=$(up out/target/product/gsi_arm64/*img)
                #zip -r out/target/product/generic_arm64/system/system.7z out/target/product/generic_arm64/system
		#curl -sL https://git.io/file-transfer | sh
                #curl --upload-file out/target/product/generic_arm64/system/system_ext/priv-app/ThemePicker/ThemePicker.apk https://transfer.sh/
		#./transfer wet out/target/product/aosp_arm64/*7z
		#echo " "
		##echo "$zip"
#}
#make_metalava
#make_rom
